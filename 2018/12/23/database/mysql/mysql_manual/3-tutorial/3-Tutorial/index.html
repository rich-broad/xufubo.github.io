<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="MySQL,数据库,">










<meta name="description" content="Tutorial本章主要介绍通过mysql这个程序链接到MySQL服务器，并对服务器进行使用。mysql程序是一个终端交互程序，用于链接到MySQL服务器，提交查询并查看结果。mysql也可在批处理模式下使用：先将查询放在一个文件中，然后告诉 mysql执行文件的内容。本章介绍这两种使用方式。本章只是一个简单的入门教程。要查看mysql提供的列表，请使用mysql –help。本章主要是对mysq">
<meta name="keywords" content="MySQL,数据库">
<meta property="og:type" content="article">
<meta property="og:title" content="MySQL 快速入门">
<meta property="og:url" content="http://yoursite.com/2018/12/23/database/mysql/mysql_manual/3-tutorial/3-Tutorial/index.html">
<meta property="og:site_name" content="xufubo">
<meta property="og:description" content="Tutorial本章主要介绍通过mysql这个程序链接到MySQL服务器，并对服务器进行使用。mysql程序是一个终端交互程序，用于链接到MySQL服务器，提交查询并查看结果。mysql也可在批处理模式下使用：先将查询放在一个文件中，然后告诉 mysql执行文件的内容。本章介绍这两种使用方式。本章只是一个简单的入门教程。要查看mysql提供的列表，请使用mysql –help。本章主要是对mysq">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2018-12-23T11:45:56.364Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="MySQL 快速入门">
<meta name="twitter:description" content="Tutorial本章主要介绍通过mysql这个程序链接到MySQL服务器，并对服务器进行使用。mysql程序是一个终端交互程序，用于链接到MySQL服务器，提交查询并查看结果。mysql也可在批处理模式下使用：先将查询放在一个文件中，然后告诉 mysql执行文件的内容。本章介绍这两种使用方式。本章只是一个简单的入门教程。要查看mysql提供的列表，请使用mysql –help。本章主要是对mysq">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/12/23/database/mysql/mysql_manual/3-tutorial/3-Tutorial/">





  <title>MySQL 快速入门 | xufubo</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">xufubo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/12/23/database/mysql/mysql_manual/3-tutorial/3-Tutorial/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xufubo">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="xufubo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">MySQL 快速入门</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-12-23T17:59:56+08:00">
                2018-12-23
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/MySQL-manual/" itemprop="url" rel="index">
                    <span itemprop="name">MySQL manual</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Tutorial"><a href="#Tutorial" class="headerlink" title="Tutorial"></a>Tutorial</h1><p>本章主要介绍通过mysql这个程序链接到MySQL服务器，并对服务器进行使用。mysql程序是一个终端交互程序，用于链接到MySQL服务器，提交查询并查看结果。mysql也可在批处理模式下使用：先将查询放在一个文件中，然后告诉 mysql执行文件的内容。本章介绍这两种使用方式。本章只是一个简单的入门教程。要查看mysql提供的列表，请使用mysql –help。<br>本章主要是对mysql简单的使用。首先有个感性的认识。  </p>
<hr>
<h2 id="1、连接和断开服务器"><a href="#1、连接和断开服务器" class="headerlink" title="1、连接和断开服务器"></a>1、连接和断开服务器</h2><p>连接时通常需要指定要链接的主机、端口、用户名、密码。<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql -h host -u user –P 3306 -p </span><br><span class="line">Enter password: ********</span><br></pre></td></tr></table></figure></p>
<p>如果客户端与服务器在一台机器上，可以：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql -u user -p</span><br></pre></td></tr></table></figure></p>
<p>键入QUIT来退出mysql程序。   </p>
<hr>
<h2 id="2、输入查询"><a href="#2、输入查询" class="headerlink" title="2、输入查询"></a>2、输入查询</h2><p>MySQL可以包含多个数据库，如上与服务器建立连接后并未选择任何数据库。此时依然可以与mysqld进行交互。例如像MySQL服务器询问版本和当前日期：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">VERSION</span>(), <span class="keyword">CURRENT_DATE</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">version</span>(), <span class="keyword">current_date</span>;</span><br><span class="line"><span class="keyword">SeLeCt</span> <span class="keyword">vErSiOn</span>(), <span class="keyword">current_DATE</span>;</span><br></pre></td></tr></table></figure></p>
<p>如上可见，对于关键字，MySQL不区分大小写。<br>同一个查询也可以位于多行：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT</span><br><span class="line">     -&gt; USER()</span><br><span class="line">     -&gt; ,     </span><br><span class="line">     -&gt; CURRENT_DATE; </span><br><span class="line">+<span class="comment">---------------+--------------+ </span></span><br><span class="line">| USER()        | CURRENT_DATE |</span><br><span class="line">+<span class="comment">---------------+--------------+ </span></span><br><span class="line">| jon@localhost | 2010-08-06   | </span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br></pre></td></tr></table></figure></p>
<p>此例中，在第一行提示符为mysql&gt;，后续的为-&gt;,表示mysql还未看到一个完整的语句。正在等待其余的输入。如果不想执行正在输入的查询，可以输入\c，如下：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT</span><br><span class="line">-&gt; USER()     </span><br><span class="line">-&gt; \c </span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></p>
<p>输入\c之后，提示mysql&gt;，表示mysql准备好接受新的查询。<br>下边是mysql程序会出现的提示符即对应的含义，了解这些是有用的。  </p>
<table>
<thead>
<tr>
<th>提示</th>
<th>含义</th>
</tr>
</thead>
<tbody>
<tr>
<td>mysql&gt;</td>
<td>准备新的查询</td>
</tr>
<tr>
<td>-&gt;</td>
<td>等待多行查询的下一行</td>
</tr>
<tr>
<td>‘&gt;</td>
<td>等待下一行，等待完成一个以单引号（’）开始的字符串</td>
</tr>
<tr>
<td>“&gt;</td>
<td>等待下一行，等待完成一个以双引号（”）开头的字符串</td>
</tr>
<tr>
<td>`&gt;</td>
<td>等待下一行，等待完成一个以反引号（`）开头的标识符</td>
</tr>
<tr>
<td>/*&gt;</td>
<td>等待下一行，等待完成一个以/*开始的注释</td>
</tr>
</tbody>
</table>
<p>例如你输入如下查询：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM my_table WHERE name = 'Smith AND age &lt; 30;</span><br><span class="line">     '&gt;</span><br></pre></td></tr></table></figure></p>
<p>这时你会感到奇怪，我的查询怎么不执行？这时要注意mysql程序的提示符，mysql客户端程序认为你的字符串缺少单引号。但是你却知道，实际上你是输入错误，那么接下来可以如下输入，从而取消本查询：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM my_table WHERE name = 'Smith AND age &lt; 30;</span><br><span class="line">'&gt; '\c </span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure></p>
<p>注意要输入’\c，只输入\c不管用哈。  </p>
<hr>
<h2 id="3、创建和使用数据库"><a href="#3、创建和使用数据库" class="headerlink" title="3、创建和使用数据库"></a>3、创建和使用数据库</h2><h3 id="3-1-创建和选择数据库"><a href="#3-1-创建和选择数据库" class="headerlink" title="3.1 创建和选择数据库"></a>3.1 创建和选择数据库</h3><p>先看看当前服务器上存在哪些数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASES</span>;</span><br></pre></td></tr></table></figure></p>
<p>该语句不显示你没有权限的数据库。<br>选择某个数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">USE</span> <span class="keyword">test</span></span><br></pre></td></tr></table></figure></p>
<p>将某个数据库的所有权限赋予一个用户：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> ALL <span class="keyword">ON</span> menagerie.* <span class="keyword">TO</span> <span class="string">'your_mysql_name'</span>@<span class="string">'your_client_host'</span>;</span><br></pre></td></tr></table></figure></p>
<p>your_mysql_name是分配给你的MySQL用户名，your_client_host是要连接到服务器的主机。<br>创建一个数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> menagerie;</span><br></pre></td></tr></table></figure></p>
<p>创建之后，并不会默认选择该数据库，你必须手动执行USE语句。数据库只需要创建一次，但是每次开始mysql 会话时都必须选择它。可以通过发出USE语句来执行此操作 。或者，可以在命令行调用mysql时选择数据库。只需在连接参数最后指定其名称。例如：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql -h host -u user -p menagerie</span><br><span class="line">Enter password: ********</span><br></pre></td></tr></table></figure></p>
<p>注意：menagerie为数据库，并不是密码，如果要在p之后跟随密码，p和密码之间不可以有空格。但是，不建议将密码放在命令行上，因为这样做会使其被登录在您的计算机上的其他用户所窥探。<br>您可以随时查看当前使用哪个数据库。 SELECT DATABASE()  </p>
<h3 id="3-2-创建表"><a href="#3-2-创建表" class="headerlink" title="3.2 创建表"></a>3.2 创建表</h3><p>先看看当前数据库中有哪些表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLES</span>; </span><br><span class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p>
<p>创建一张宠物表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> pet (<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>), owner <span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">     species <span class="built_in">VARCHAR</span>(<span class="number">20</span>), sex <span class="built_in">CHAR</span>(<span class="number">1</span>), birth <span class="built_in">DATE</span>, death <span class="built_in">DATE</span>);</span><br></pre></td></tr></table></figure></p>
<p>该表记录宠物的最为基本的信息：名称，所有者，物种，性别，出生和死亡。  </p>
<h3 id="3-3-将数据装载到表中"><a href="#3-3-将数据装载到表中" class="headerlink" title="3.3 将数据装载到表中"></a>3.3 将数据装载到表中</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> <span class="keyword">LOCAL</span> <span class="keyword">INFILE</span> <span class="string">'/path/pet.txt'</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> pet;</span><br></pre></td></tr></table></figure>
<p>如果在Windows上使用\r\n用作行终止符的编辑器创建该文件 ，则应改用以下语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">LOAD</span> <span class="keyword">DATA</span> <span class="keyword">LOCAL</span> <span class="keyword">INFILE</span> <span class="string">'/path/pet.txt'</span> <span class="keyword">INTO</span> <span class="keyword">TABLE</span> pet <span class="keyword">LINES</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\r\n'</span>;</span><br></pre></td></tr></table></figure></p>
<p>如果需要，可以在LOAD DATA语句中明确指定列值之间的分隔符和行尾标记，默认值为制表符和换行符。<br>也可以插入一条记录：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> pet <span class="keyword">VALUES</span> (<span class="string">'Puffball'</span>,<span class="string">'Diane'</span>,<span class="string">'hamster'</span>,<span class="string">'f'</span>,<span class="string">'1999-03-30'</span>,<span class="literal">NULL</span>);</span><br></pre></td></tr></table></figure></p>
<h3 id="3-4-从表中查询信息"><a href="#3-4-从表中查询信息" class="headerlink" title="3.4 从表中查询信息"></a>3.4 从表中查询信息</h3><h4 id="3-4-1-查询所有数据："><a href="#3-4-1-查询所有数据：" class="headerlink" title="3.4.1 查询所有数据："></a>3.4.1 查询所有数据：</h4><p>从表 中检索所有内容的最简单的形式：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet;</span><br><span class="line">+<span class="comment">----------+--------+---------+------+------------+------------+ </span></span><br><span class="line">| name     | owner  | species | sex  | birth      | death      | </span><br><span class="line">+<span class="comment">----------+--------+---------+------+------------+------------+ </span></span><br><span class="line">| Fluffy   | Harold | cat     | f    | 1993-02-04 | NULL       | </span><br><span class="line">| Claws    | Gwen   | cat     | m    | 1994-03-17 | NULL       | </span><br><span class="line">| Buffy    | Harold | dog     | f    | 1989-05-13 | NULL       | </span><br><span class="line">| Fang     | Benny  | dog     | m    | 1990-08-27 | NULL       | </span><br><span class="line">| Bowser   | Diane  | dog     | m    | 1979-08-31 | 1995-07-29 | </span><br><span class="line">| Chirpy   | Gwen   | bird    | f    | 1998-09-11 | NULL       | </span><br><span class="line">| Whistler | Gwen   | bird    | NULL | 1997-12-09 | NULL       | </span><br><span class="line">| Slim     | Benny  | snake   | m    | 1996-04-29 | NULL       | </span><br><span class="line">| Puffball | Diane  | hamster | f    | 1999-03-30 | NULL       | </span><br><span class="line">+<span class="comment">----------+--------+---------+------+------------+------------+</span></span><br></pre></td></tr></table></figure></p>
<p>如果你发现表格中某些数据不正确，可以使用update语句：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">UPDATE</span> pet <span class="keyword">SET</span> birth = <span class="string">'1989-08-31'</span> <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Bowser'</span>;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-4-2-选择特定的行"><a href="#3-4-2-选择特定的行" class="headerlink" title="3.4.2 选择特定的行"></a>3.4.2 选择特定的行</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> = <span class="string">'Bowser'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> birth &gt;= <span class="string">'1998-1-1'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> species = <span class="string">'dog'</span> <span class="keyword">AND</span> sex = <span class="string">'f'</span>;</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> species = <span class="string">'snake'</span> <span class="keyword">OR</span> species = <span class="string">'bird'</span>;</span><br></pre></td></tr></table></figure>
<p>AND和OR很容易混乱，尽管<strong><em>AND优先级高于OR</em></strong>。但是在使用时最好明确用括号包起来：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> (species = <span class="string">'cat'</span> <span class="keyword">AND</span> sex = <span class="string">'m'</span>) <span class="keyword">OR</span> (species = <span class="string">'dog'</span> <span class="keyword">AND</span> sex = <span class="string">'f'</span>);</span><br></pre></td></tr></table></figure></p>
<h4 id="3-4-3-选择特定的列"><a href="#3-4-3-选择特定的列" class="headerlink" title="3.4.3 选择特定的列"></a>3.4.3 选择特定的列</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet;</span><br><span class="line"><span class="keyword">SELECT</span> owner <span class="keyword">FROM</span> pet;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DISTINCT</span> owner <span class="keyword">FROM</span> pet;</span><br><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, species, birth <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> species = <span class="string">'dog'</span> <span class="keyword">OR</span> species = <span class="string">'cat'</span>;</span><br></pre></td></tr></table></figure>
<h4 id="3-4-4-排序行"><a href="#3-4-4-排序行" class="headerlink" title="3.4.4 排序行"></a>3.4.4 排序行</h4><p>按日期排序：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet <span class="keyword">ORDER</span> <span class="keyword">BY</span> birth;</span><br></pre></td></tr></table></figure></p>
<p>默认为升序，降序排列需要明确指定：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet <span class="keyword">ORDER</span> <span class="keyword">BY</span> birth <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure></p>
<p>可以按多个列排序，例如：按照动物类型升序（默认）排列，按照出生日期降序排列：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, species, birth <span class="keyword">FROM</span> pet <span class="keyword">ORDER</span> <span class="keyword">BY</span> species, birth <span class="keyword">DESC</span>;</span><br><span class="line">+<span class="comment">----------+---------+------------+ </span></span><br><span class="line">| name     | species | birth      | </span><br><span class="line">+<span class="comment">----------+---------+------------+ </span></span><br><span class="line">| Chirpy   | bird    | 1998-09-11 | </span><br><span class="line">| Whistler | bird    | 1997-12-09 | </span><br><span class="line">| Claws    | cat     | 1994-03-17 | </span><br><span class="line">| Fluffy   | cat     | 1993-02-04 | </span><br><span class="line">| Fang     | dog     | 1990-08-27 | </span><br><span class="line">| Bowser   | dog     | 1989-08-31 | </span><br><span class="line">| Buffy    | dog     | 1989-05-13 | </span><br><span class="line">| Puffball | hamster | 1999-03-30 | </span><br><span class="line">| Slim     | snake   | 1996-04-29 | </span><br><span class="line">+<span class="comment">----------+---------+------------+</span></span><br></pre></td></tr></table></figure></p>
<p><strong><em>DESC关键字仅适用于它之前的列名（birth）; 不影响species列的排序顺序。</em></strong>  </p>
<h4 id="3-4-5-日期计算"><a href="#3-4-5-日期计算" class="headerlink" title="3.4.5 日期计算"></a>3.4.5 日期计算</h4><p>MySQL提供了几种可用于执行日期计算的功能，例如计算年龄或提取部分日期。要确定你宠物的年龄，请使用 TIMESTAMPDIFF()函数。它依据你希望的表达单位和两个日期的差异求的计算结果。以下查询显示每只宠物的出生日期，当前日期和年龄。使用 别名（age）来使最终输出列标签更有意义。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth, <span class="keyword">CURDATE</span>(),</span><br><span class="line"><span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">YEAR</span>,birth,<span class="keyword">CURDATE</span>()) <span class="keyword">AS</span> age</span><br><span class="line"><span class="keyword">FROM</span> pet; </span><br><span class="line">+<span class="comment">----------+------------+------------+------+ </span></span><br><span class="line">| name     | birth      | CURDATE()  | age  | </span><br><span class="line">+<span class="comment">----------+------------+------------+------+ </span></span><br><span class="line">| Fluffy   | 1993-02-04 | 2003-08-19 |   10 | </span><br><span class="line">| Claws    | 1994-03-17 | 2003-08-19 |    9 | </span><br><span class="line">| Buffy    | 1989-05-13 | 2003-08-19 |   14 | </span><br><span class="line">| Fang     | 1990-08-27 | 2003-08-19 |   12 | </span><br><span class="line">| Bowser   | 1989-08-31 | 2003-08-19 |   13 | </span><br><span class="line">| Chirpy   | 1998-09-11 | 2003-08-19 |    4 | </span><br><span class="line">| Whistler | 1997-12-09 | 2003-08-19 |    5 | </span><br><span class="line">| Slim     | 1996-04-29 | 2003-08-19 |    7 | </span><br><span class="line">| Puffball | 1999-03-30 | 2003-08-19 |    4 | </span><br><span class="line">+<span class="comment">----------+------------+------------+------+</span></span><br></pre></td></tr></table></figure></p>
<p>也可以将结果以某种顺序输出:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth, <span class="keyword">CURDATE</span>(),</span><br><span class="line"><span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">YEAR</span>,birth,<span class="keyword">CURDATE</span>()) <span class="keyword">AS</span> age     </span><br><span class="line"><span class="keyword">FROM</span> pet <span class="keyword">ORDER</span> <span class="keyword">BY</span> <span class="keyword">name</span>; </span><br><span class="line">+<span class="comment">----------+------------+------------+------+ </span></span><br><span class="line">| name     | birth      | CURDATE()  | age  | </span><br><span class="line">+<span class="comment">----------+------------+------------+------+ </span></span><br><span class="line">| Bowser   | 1989-08-31 | 2003-08-19 |   13 | </span><br><span class="line">| Buffy    | 1989-05-13 | 2003-08-19 |   14 | </span><br><span class="line">| Chirpy   | 1998-09-11 | 2003-08-19 |    4 | </span><br><span class="line">| Claws    | 1994-03-17 | 2003-08-19 |    9 | </span><br><span class="line">| Fang     | 1990-08-27 | 2003-08-19 |   12 | </span><br><span class="line">| Fluffy   | 1993-02-04 | 2003-08-19 |   10 | </span><br><span class="line">| Puffball | 1999-03-30 | 2003-08-19 |    4 | </span><br><span class="line">| Slim     | 1996-04-29 | 2003-08-19 |    7 | </span><br><span class="line">| Whistler | 1997-12-09 | 2003-08-19 |    5 | </span><br><span class="line">+<span class="comment">----------+------------+------------+------+</span></span><br></pre></td></tr></table></figure></p>
<p>如果你想知道下个月有哪些动物过生日呢？对于这种类型的计算，年和日是无关紧要的; 你只需要提取birth列的月份部分 。MySQL提供了用于提取日期的部分，如一些函数 YEAR()， MONTH()和 DAYOFMONTH()。 MONTH()是现在需要的函数，看看它如何工作：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth, <span class="keyword">MONTH</span>(birth) <span class="keyword">FROM</span> pet; </span><br><span class="line">+<span class="comment">----------+------------+--------------+ </span></span><br><span class="line">| name     | birth      | MONTH(birth) | </span><br><span class="line">+<span class="comment">----------+------------+--------------+ </span></span><br><span class="line">| Fluffy   | 1993-02-04 |            2 | </span><br><span class="line">| Claws    | 1994-03-17 |            3 | </span><br><span class="line">| Buffy    | 1989-05-13 |            5 | </span><br><span class="line">| Fang     | 1990-08-27 |            8 | </span><br><span class="line">| Bowser   | 1989-08-31 |            8 | </span><br><span class="line">| Chirpy   | 1998-09-11 |            9 | </span><br><span class="line">| Whistler | 1997-12-09 |           12 | </span><br><span class="line">| Slim     | 1996-04-29 |            4 | </span><br><span class="line">| Puffball | 1999-03-30 |            3 | </span><br><span class="line">+<span class="comment">----------+------------+--------------+</span></span><br></pre></td></tr></table></figure></p>
<p>假设当月是4月。找出在五月（月5）里出生的动物：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(birth) = <span class="number">5</span>;</span><br></pre></td></tr></table></figure></p>
<p>如果当月为12月，那么总不能写成13月吧。你可以这么写：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet</span><br><span class="line">     <span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(birth) = <span class="keyword">MONTH</span>(<span class="keyword">DATE_ADD</span>(<span class="keyword">CURDATE</span>(),<span class="built_in">INTERVAL</span> <span class="number">1</span> <span class="keyword">MONTH</span>));</span><br></pre></td></tr></table></figure></p>
<p>DATE_ADD()函数可以参考MySQL手册或者网上查查其用法。或者：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">name</span>, birth <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">MONTH</span>(birth) = <span class="keyword">MOD</span>(<span class="keyword">MONTH</span>(<span class="keyword">CURDATE</span>()), <span class="number">12</span>) + <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<h4 id="3-4-6-使用NULL值"><a href="#3-4-6-使用NULL值" class="headerlink" title="3.4.6 使用NULL值"></a>3.4.6 使用NULL值</h4><p>NULL在概念上是一个未知的值。要测试NULL，使用 IS NULL和IS NOT NULL运算符，如下所示：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="number">1</span> <span class="keyword">IS</span> <span class="literal">NULL</span>, <span class="number">1</span> <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>; </span><br><span class="line">+<span class="comment">-----------+---------------+ </span></span><br><span class="line">| 1 IS NULL | 1 IS NOT NULL | </span><br><span class="line">+<span class="comment">-----------+---------------+ </span></span><br><span class="line">|         0 |             1 | </span><br><span class="line">+<span class="comment">-----------+---------------+</span></span><br></pre></td></tr></table></figure></p>
<p>不能使用比较运算符，如：=、&lt;、&gt;、&lt;&gt;等。因为一个不知道的值与其他的值比结果还是不知道即：NULL，一次作比较无任何意义。GROUP BY中两个NULL值被认为是相等的。当执行ORDER BY时，如果执行ORDER BY … ASC，则首先显示NULL值，如果执行ORDER BY … DESC，则最后显示NULL值。</p>
<h4 id="3-4-7-模式匹配"><a href="#3-4-7-模式匹配" class="headerlink" title="3.4.7 模式匹配"></a>3.4.7 模式匹配</h4><p>MySQL提供标准的SQL模式匹配以及基于扩展的正则表达式的模式匹配，类似于Unix实用程序（如vi，grep和sed）所使用的正则表达式。SQL模式匹配中：_匹配任意单个字符，%匹配任意多个字符（包括0个）。在MySQL中，默认情况下，SQL模式不区分大小写。这里显示了一些示例。当您使用SQL模式时，不要使用=或&lt;&gt;。应该使用LIKE或NOT LIKE比较运算符。<br><strong><em>在MySQL中，默认情况下，SQL模式不区分大小写这一点请看下边的例子</em></strong><br>找到名字以b开头的数据：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'b%'</span>;</span><br><span class="line">+<span class="comment">--------+--------+---------+------+------------+------------+</span></span><br><span class="line">| name   | owner  | species | sex  | birth      | death      |</span><br><span class="line">+<span class="comment">--------+--------+---------+------+------------+------------+</span></span><br><span class="line">| Buffy  | Harold | dog     | f    | 1989-05-13 | NULL       |</span><br><span class="line">| Bowser | Diane  | dog     | m    | 1989-08-31 | 1995-07-29 |</span><br><span class="line">+<span class="comment">--------+--------+---------+------+------------+------------+</span></span><br><span class="line"><span class="comment">-- 注意，Buffy、Bowser均为首字母大写，而模式中为小写b，即：'在MySQL中，默认情况下，SQL模式不区分大小写'</span></span><br></pre></td></tr></table></figure></p>
<p>找到名字以fy结尾的数据：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%fy'</span>;</span><br></pre></td></tr></table></figure></p>
<p>发现名字中包含w的数据：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'%w%'</span>;</span><br></pre></td></tr></table></figure></p>
<p>发现名字中恰好包含5个字符的数据，使用五个_：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> <span class="keyword">LIKE</span> <span class="string">'_____'</span>;</span><br></pre></td></tr></table></figure></p>
<p>MySQL提供的其他类型的模式匹配使用扩展的正则表达式。当你测试这种类型的模式匹配时，请使用 REGEXP和NOT REGEXP操作符（或者 RLIKE和 NOT RLIKE，它们是同义词）。以下描述了扩展的正则表达式的一些特征：  </p>
<ul>
<li>. 匹配任何单个字符。</li>
<li>字符类[…]会匹配括号内的任何字符。例如， [abc]匹配a， b或c。要命名一个字符范围，请使用破折号。[a-z] 匹配任何字母，而[0-9] 匹配任何数字。</li>
<li>*匹配其前面的事物的零个或多个实例。例如，x* 匹配任何数量的x字符， [0-9]*匹配任意数量的数字，.*匹配任何数量的任何东西。</li>
<li>REGEXP的时候，当模式匹配被测值中的任何位置时匹配成功。（这与LIKE模式匹配不同 ，只有当模式匹配整个值时才能成功）</li>
<li>为了表达必须与正在测试的值的开头或结尾相匹配，需要在模式开始处使用^或在模式结尾处使用$<br>为了演示扩展正则表达式的工作原理，将使用REGEXP重写之前的LIKE查询。<br>名字以b开头的行：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="string">'^b'</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果你真的要强制 REGEXP区分大小写，请使用BINARY关键字使其中一个字符串成为二进制字符串。此查询仅匹配在名称开头为小写b的情况：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="built_in">BINARY</span> <span class="string">'^b'</span>;</span><br></pre></td></tr></table></figure></p>
<p>名字以fy结尾的行：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="string">'fy$'</span>;</span><br></pre></td></tr></table></figure></p>
<p>名字中包含w的行：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="string">'w'</span>;</span><br></pre></td></tr></table></figure></p>
<p>因为正则表达式模式匹配成功的条件是匹配值的任何位置，因此在上一个查询中不需要在模式的两边放置一个通配符，以使其匹配整个值。<br>要查找名称正好包含五个字符的行，请使用如下语句 ：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="string">'^.....$'</span>;</span><br></pre></td></tr></table></figure></p>
<p>也可以：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> pet <span class="keyword">WHERE</span> <span class="keyword">name</span> REGEXP <span class="string">'^.&#123;5&#125;$'</span>;</span><br></pre></td></tr></table></figure></p>
<p>后续会有正则表达式的更多介绍。  </p>
<h4 id="3-4-8-行计数"><a href="#3-4-8-行计数" class="headerlink" title="3.4.8 行计数"></a>3.4.8 行计数</h4><p>计算宠物的总数：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> pet;</span><br></pre></td></tr></table></figure></p>
<p>查询，每个宠物所有者分别有多少个宠物:<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> owner, <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> pet <span class="keyword">GROUP</span> <span class="keyword">BY</span> owner;</span><br></pre></td></tr></table></figure></p>
<p>查询每种动物的数量：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT species, COUNT(*) FROM pet GROUP BY species;</span><br></pre></td></tr></table></figure></p>
<p>查询每种性别的宠物数量：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> sex, <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> pet <span class="keyword">GROUP</span> <span class="keyword">BY</span> sex; </span><br><span class="line">+<span class="comment">------+----------+ </span></span><br><span class="line">| sex  | COUNT(*) | </span><br><span class="line">+<span class="comment">------+----------+ </span></span><br><span class="line">| NULL |        1 | </span><br><span class="line">| f    |        4 | </span><br><span class="line">| m    |        4 | </span><br><span class="line">+<span class="comment">------+----------+</span></span><br></pre></td></tr></table></figure></p>
<p>NULL表示性别未知。<br>查询各个种类和性别相同的宠物的数量：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT species, sex, COUNT(*) FROM pet GROUP BY species, sex;</span><br><span class="line">+<span class="comment">---------+------+----------+ </span></span><br><span class="line">| species | sex  | COUNT(*) | </span><br><span class="line">+<span class="comment">---------+------+----------+ </span></span><br><span class="line">| bird    | NULL |        1 | </span><br><span class="line">| bird    | f    |        1 | </span><br><span class="line">| cat     | f    |        1 | </span><br><span class="line">| cat     | m    |        1 | </span><br><span class="line">| dog     | f    |        1 | </span><br><span class="line">| dog     | m    |        2 | </span><br><span class="line">| hamster | f    |        1 | </span><br><span class="line">| snake   | m    |        1 | </span><br><span class="line">+<span class="comment">---------+------+----------+</span></span><br></pre></td></tr></table></figure></p>
<p>也可以不对整个表count和group by，这通过where条件完成：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> species, sex, <span class="keyword">COUNT</span>(*) <span class="keyword">FROM</span> pet</span><br><span class="line"> <span class="keyword">WHERE</span> sex <span class="keyword">IS</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>     </span><br><span class="line"> <span class="keyword">GROUP</span> <span class="keyword">BY</span> species, sex; </span><br><span class="line">+<span class="comment">---------+------+----------+ </span></span><br><span class="line">| species | sex  | COUNT(*) | </span><br><span class="line">+<span class="comment">---------+------+----------+ </span></span><br><span class="line">| bird    | f    |        1 | </span><br><span class="line">| cat     | f    |        1 | </span><br><span class="line">| cat     | m    |        1 | </span><br><span class="line">| dog     | f    |        1 | </span><br><span class="line">| dog     | m    |        2 | </span><br><span class="line">| hamster | f    |        1 | </span><br><span class="line">| snake   | m    |        1 | </span><br><span class="line">+<span class="comment">---------+------+----------+</span></span><br></pre></td></tr></table></figure></p>
<p>如果启用了SQL模式： ONLY_FULL_GROUP_BY，那么如下会出错：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SET sql_mode = 'ONLY_FULL_GROUP_BY'; </span><br><span class="line">Query OK, 0 rows affected (0.00 sec)  </span><br><span class="line">mysql&gt; SELECT owner, COUNT(*) FROM pet; </span><br><span class="line">ERROR 1140 (42000): In aggregated query without GROUP BY, expression </span><br><span class="line"><span class="comment">#1 of SELECT list contains nonaggregated column 'menagerie.pet.owner'; </span></span><br><span class="line">this is incompatible <span class="keyword">with</span> sql_mode=only_full_group_by</span><br></pre></td></tr></table></figure></p>
<p>如果ONLY_FULL_GROUP_BY未启用，则通过将所有行视为单个组来处理查询，但为每个命名列选择的值是不确定的。服务器可以自由地从任何行中选择值：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SET sql_mode = ''; </span><br><span class="line">Query OK, 0 rows affected (0.00 sec)  </span><br><span class="line">mysql&gt; SELECT owner, COUNT(*) FROM pet; </span><br><span class="line">+<span class="comment">--------+----------+ </span></span><br><span class="line">| owner  | COUNT(*) | </span><br><span class="line">+<span class="comment">--------+----------+ </span></span><br><span class="line">| Harold |        9 | </span><br><span class="line">+<span class="comment">--------+----------+ </span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure></p>
<h4 id="3-4-9-使用多个表"><a href="#3-4-9-使用多个表" class="headerlink" title="3.4.9 使用多个表"></a>3.4.9 使用多个表</h4><p>前面我们有一张包含宠物基本信息的表pet，包含如下列：名称，所有者，物种，性别，出生和死亡。<br>现在需要记录这些宠物的更多信息，即关于宠物的一些活动，为此，需要另外一张表：event。如下：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">event</span> (<span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>), <span class="built_in">date</span> <span class="built_in">DATE</span>,</span><br><span class="line">      <span class="keyword">type</span> <span class="built_in">VARCHAR</span>(<span class="number">15</span>), remark <span class="built_in">VARCHAR</span>(<span class="number">255</span>));</span><br></pre></td></tr></table></figure></p>
<p>该表包含字段：名称，时间日期、类型、备注。<br>与pet表一样，通过创建包含以下信息的制表符分隔的文本文件来创建数据。  </p>
<table>
<thead>
<tr>
<th>name</th>
<th>date</th>
<th>type</th>
<th>remark</th>
</tr>
</thead>
<tbody>
<tr>
<td>Fluffy</td>
<td>1995-05-15</td>
<td>litter</td>
<td>4 kittens, 3 female, 1 male</td>
</tr>
<tr>
<td>Buffy</td>
<td>1993-06-23</td>
<td>litter</td>
<td>5 puppies, 2 female, 3 male</td>
</tr>
<tr>
<td>Buffy</td>
<td>1994-06-19</td>
<td>litter</td>
<td>3 puppies, 3 female</td>
</tr>
<tr>
<td>Chirpy</td>
<td>1999-03-21</td>
<td>vet</td>
<td>needed beak straightened</td>
</tr>
<tr>
<td>Slim</td>
<td>1997-08-03</td>
<td>vet</td>
<td>broken rib</td>
</tr>
<tr>
<td>Bowser</td>
<td>1991-10-12</td>
<td>kennel</td>
<td></td>
</tr>
<tr>
<td>Fang</td>
<td>1991-10-12</td>
<td>kennel</td>
<td></td>
</tr>
<tr>
<td>Fang</td>
<td>1998-08-28</td>
<td>birthday</td>
<td>Gave him a new chew toy</td>
</tr>
<tr>
<td>Claws</td>
<td>1998-03-17</td>
<td>birthday</td>
<td>Gave him a new flea collar</td>
</tr>
<tr>
<td>Whistler</td>
<td>1998-12-09</td>
<td>birthday</td>
<td>First birthday</td>
</tr>
</tbody>
</table>
<p>假设你要查询宠物的年龄以及它的一些事件，但是这些信息在pet或event中的任何一张表中都无法获取，因此需要查询两张表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> pet.name,</span><br><span class="line"> <span class="keyword">TIMESTAMPDIFF</span>(<span class="keyword">YEAR</span>,birth,<span class="built_in">date</span>) <span class="keyword">AS</span> age,     </span><br><span class="line"> remark     </span><br><span class="line"> <span class="keyword">FROM</span> pet <span class="keyword">INNER</span> <span class="keyword">JOIN</span> <span class="keyword">event</span>     </span><br><span class="line">   <span class="keyword">ON</span> pet.name = event.name    </span><br><span class="line">  <span class="keyword">WHERE</span> event.type = <span class="string">'litter'</span>; </span><br><span class="line">+<span class="comment">--------+------+-----------------------------+ </span></span><br><span class="line">| name   | age  | remark                      | </span><br><span class="line">+<span class="comment">--------+------+-----------------------------+ </span></span><br><span class="line">| Fluffy |    2 | 4 kittens, 3 female, 1 male | </span><br><span class="line">| Buffy  |    4 | 5 puppies, 2 female, 3 male | </span><br><span class="line">| Buffy  |    5 | 3 puppies, 3 female         | </span><br><span class="line">+<span class="comment">--------+------+-----------------------------+</span></span><br></pre></td></tr></table></figure></p>
<p>注意：因为name列在两个表中都会出现，所以必须具体说明引用哪个表的该列。这可以通过将表名称添加到列名前来完成。<br>以上是两个不同的表进行连接，有些时候需要同一个表进行连接，例如：你想给物种配对，即：同一种宠物的不同性别的结合，此时就需要连接pet表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> p1.name, p1.sex, p2.name, p2.sex, p1.species</span><br><span class="line"> <span class="keyword">FROM</span> pet <span class="keyword">AS</span> p1 <span class="keyword">INNER</span> <span class="keyword">JOIN</span> pet <span class="keyword">AS</span> p2     </span><br><span class="line">   <span class="keyword">ON</span> p1.species = p2.species <span class="keyword">AND</span> p1.sex = <span class="string">'f'</span> <span class="keyword">AND</span> p2.sex = <span class="string">'m'</span>; </span><br><span class="line">+<span class="comment">--------+------+--------+------+---------+ </span></span><br><span class="line">| name   | sex  | name   | sex  | species |</span><br><span class="line">+<span class="comment">--------+------+--------+------+---------+ </span></span><br><span class="line">| Fluffy | f    | Claws  | m    | cat     | </span><br><span class="line">| Buffy  | f    | Fang   | m    | dog     | </span><br><span class="line">| Buffy  | f    | Bowser | m    | dog     | </span><br><span class="line">+<span class="comment">--------+------+--------+------+---------+</span></span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="4、获取数据库和表信息"><a href="#4、获取数据库和表信息" class="headerlink" title="4、获取数据库和表信息"></a>4、获取数据库和表信息</h2><p>如果你忘记了当前数据库、数据库名、表名等等该怎么办？<br>展示服务器管理的各个数据库名字：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">DATABASE</span>;</span><br></pre></td></tr></table></figure></p>
<p>查看当前选择的数据库：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">DATABASE</span>();</span><br></pre></td></tr></table></figure></p>
<p>查看数据库中有那些表：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SHOW</span> <span class="keyword">TABLES</span>;</span><br></pre></td></tr></table></figure></p>
<p>了解表的结构：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DESCRIBE</span> pet;</span><br></pre></td></tr></table></figure></p>
<p>也可以使用DESC作为简写，还可以使用SHOW CREATE TABLE tab_name来看某个表的定义。   </p>
<hr>
<h2 id="5、在批处理模式下使用mysql"><a href="#5、在批处理模式下使用mysql" class="headerlink" title="5、在批处理模式下使用mysql"></a>5、在批处理模式下使用mysql</h2><p>在前面的部分中，以交互方式使用mysql输入语句并查看结果。也可以在批处理模式下运行mysql。为此，将要运行的语句放在一个文件中，然后告诉mysql从文件中读取其输入：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql &lt; batch-file</span><br></pre></td></tr></table></figure></p>
<p>如果需要在命令行中指定连接参数，命令可能如下所示：<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql -h host -u user -p &lt; batch-file </span><br><span class="line">Enter password: ********</span><br></pre></td></tr></table></figure></p>
<p>当以这种方式使用mysql时，你将要创建一个脚本文件，然后执行该脚本。<br>如果你希望即使其中的某些语句产生错误脚本也继续执行，则应使用 –force命令行选项。<br>为什么要使用脚本？以下是几个原因：  </p>
<ul>
<li>反复（例如每天或每周）运行查询，使其成为一个脚本，可以在每次执行它时避免重新输入。</li>
<li>可以通过复制和编辑脚本文件来生成与现有查询类似的新查询。</li>
<li>在开发查询时，批处理模式也很有用，特别是对于多行语句或多语句序列。如果你犯了一个错误，你不需要重新输入一切。只需编辑你的脚本来纠正错误，然后告诉mysql再次执行它。</li>
<li><p>如果有一个产生大量输出的查询，你可以通过如下方式处理，而不是看着它从屏幕顶部滚动：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql &lt; batch-file | more</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以将输出捕获到文件中并进一步处理：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">shell&gt;</span> mysql &lt; batch-file &gt; mysql.out</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以将脚本分发给其他人，以便他们也可以运行语句。</p>
</li>
<li>某些情况不允许交互式使用，例如，当你从cron作业运行查询时。在这种情况下，必须使用批处理模式。<br>当以批处理模式运行mysql时，默认的输出格式与交互式不同，例如，SELECT DISTINCT species FROM pet在mysql以交互方式运行时，输出如下所示 ：  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">+<span class="comment">---------+ </span></span><br><span class="line">| species | </span><br><span class="line">+<span class="comment">---------+ </span></span><br><span class="line">| bird    | </span><br><span class="line">| cat     | </span><br><span class="line">| dog     | </span><br><span class="line">| hamster | </span><br><span class="line">| snake   | </span><br><span class="line">+<span class="comment">---------+</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>在批处理模式下，输出如下所示：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">species</span><br><span class="line">bird</span><br><span class="line">cat </span><br><span class="line">dog </span><br><span class="line">hamster </span><br><span class="line">snake</span><br></pre></td></tr></table></figure></p>
<p>如果要以批处理方式获取交互式的输出格式，请使用mysql -t。要回传输出执行的语句，请使用mysql -v。<br>还可以在mysql启动后，在mysql提示符下，使用 source 命令或者. 来执行脚本。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; source filename; </span><br><span class="line">mysql&gt; \. filename</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="6、常见的查询示例"><a href="#6、常见的查询示例" class="headerlink" title="6、常见的查询示例"></a>6、常见的查询示例</h2><p>本节列出一些常用的查询示例。基础数据如下：<br>一张商品交易表，即：各种经销商（dealer）对文章的交易价格的表，每一篇文章可以被多个经销商销售，同一篇文章不同的经销商可以有不同的价格。因此该表的主键为（article, dealer）。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> shop (</span><br><span class="line">article <span class="built_in">INT</span>(<span class="number">4</span>) <span class="keyword">UNSIGNED</span> ZEROFILL <span class="keyword">DEFAULT</span> <span class="string">'0000'</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,     </span><br><span class="line">dealer  <span class="built_in">CHAR</span>(<span class="number">20</span>)                 <span class="keyword">DEFAULT</span> <span class="string">''</span>     <span class="keyword">NOT</span> <span class="literal">NULL</span>,     </span><br><span class="line">price   <span class="keyword">DOUBLE</span>(<span class="number">16</span>,<span class="number">2</span>)             <span class="keyword">DEFAULT</span> <span class="string">'0.00'</span> <span class="keyword">NOT</span> <span class="literal">NULL</span>,     </span><br><span class="line">PRIMARY <span class="keyword">KEY</span>(article, dealer)); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shop <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>,<span class="string">'A'</span>,<span class="number">3.45</span>),(<span class="number">1</span>,<span class="string">'B'</span>,<span class="number">3.99</span>),(<span class="number">2</span>,<span class="string">'A'</span>,<span class="number">10.99</span>),(<span class="number">3</span>,<span class="string">'B'</span>,<span class="number">1.45</span>),   (<span class="number">3</span>,<span class="string">'C'</span>,<span class="number">1.69</span>),(<span class="number">3</span>,<span class="string">'D'</span>,<span class="number">1.25</span>),(<span class="number">4</span>,<span class="string">'D'</span>,<span class="number">19.95</span>);</span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> shop;  </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">| article | dealer | price | </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">|    0001 | A      |  3.45 | </span><br><span class="line">|    0001 | B      |  3.99 | </span><br><span class="line">|    0002 | A      | 10.99 | </span><br><span class="line">|    0003 | B      |  1.45 | </span><br><span class="line">|    0003 | C      |  1.69 | </span><br><span class="line">|    0003 | D      |  1.25 | </span><br><span class="line">|    0004 | D      | 19.95 | </span><br><span class="line">+<span class="comment">---------+--------+-------+</span></span><br></pre></td></tr></table></figure></p>
<h4 id="6-1-最大值"><a href="#6-1-最大值" class="headerlink" title="6.1 最大值"></a>6.1 最大值</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">MAX</span>(article) <span class="keyword">AS</span> article <span class="keyword">FROM</span> shop;  </span><br><span class="line">+<span class="comment">---------+ </span></span><br><span class="line">| article | </span><br><span class="line">+<span class="comment">---------+ </span></span><br><span class="line">|       4 | </span><br><span class="line">+<span class="comment">---------+</span></span><br></pre></td></tr></table></figure>
<h3 id="6-2-查询最大列的行"><a href="#6-2-查询最大列的行" class="headerlink" title="6.2 查询最大列的行"></a>6.2 查询最大列的行</h3><p>任务：找出价格最贵的文章对应的信息：<br>即：该表中哪一行数据的price最大，因此先要求出该表中price的最大值，然后以他为条件查询：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> article, dealer, price <span class="keyword">FROM</span>   shop <span class="keyword">WHERE</span>  price=(<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(price) <span class="keyword">FROM</span> shop);</span><br></pre></td></tr></table></figure></p>
<p>其他方案：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s1.article, s1.dealer, s1.price </span><br><span class="line"><span class="keyword">FROM</span> shop s1 <span class="keyword">LEFT</span> <span class="keyword">JOIN</span> shop s2 <span class="keyword">ON</span> s1.price &lt; s2.price </span><br><span class="line"><span class="keyword">WHERE</span> s2.article <span class="keyword">IS</span> <span class="literal">NULL</span>;  </span><br><span class="line"><span class="keyword">SELECT</span> article, dealer, price <span class="keyword">FROM</span> shop <span class="keyword">ORDER</span> <span class="keyword">BY</span> price <span class="keyword">DESC</span> <span class="keyword">LIMIT</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure></p>
<p>注意：如果有几个最贵的文章，每个价格为19.95，LIMIT解决方案将只显示其中之一。即：这个不通用。  </p>
<h3 id="6-3-每个分组中的最大值"><a href="#6-3-每个分组中的最大值" class="headerlink" title="6.3 每个分组中的最大值"></a>6.3 每个分组中的最大值</h3><p>任务：找到每篇文章最高的价格。<br>先按照文章分组，再求每组的最大值：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> article, <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> price <span class="keyword">FROM</span>   shop <span class="keyword">GROUP</span> <span class="keyword">BY</span> article;</span><br></pre></td></tr></table></figure></p>
<h3 id="6-4-找出每组中包含特定列最大值的行"><a href="#6-4-找出每组中包含特定列最大值的行" class="headerlink" title="6.4 找出每组中包含特定列最大值的行"></a>6.4 找出每组中包含特定列最大值的行</h3><p>任务：对于每篇文章，找到价格最昂贵的经销商。<br>即：以文章分组，找出每组中价格最大的行。可以如下完成：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> article, dealer, price </span><br><span class="line"><span class="keyword">FROM</span>   shop s1 </span><br><span class="line"><span class="keyword">WHERE</span>  price=(<span class="keyword">SELECT</span> <span class="keyword">MAX</span>(s2.price)</span><br><span class="line"><span class="keyword">FROM</span> shop s2</span><br><span class="line"><span class="keyword">WHERE</span> s1.article = s2.article);  </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">| article | dealer | price | </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">|    0001 | B      |  3.99 | </span><br><span class="line">|    0002 | A      | 10.99 | </span><br><span class="line">|    0003 | C      |  1.69 | </span><br><span class="line">|    0004 | D      | 19.95 | </span><br><span class="line">+<span class="comment">---------+--------+-------+</span></span><br></pre></td></tr></table></figure></p>
<p>即：对于每一行，处理where条件，首先计算出对于这一行数据中这一个文章ID的价格的最大值。然后选择出对应的列。<br>上述示例使用了相关子查询，MySQL可能不支持，也可以如下完成：<br>思路：首先找出每篇文章最大的价格对应的行：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> article, <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> price   <span class="keyword">FROM</span> shop   <span class="keyword">GROUP</span> <span class="keyword">BY</span> article</span><br></pre></td></tr></table></figure></p>
<p>然后与自己链接，目的是为了查询到其他的列数据。但是链接条件是文章ID和价格都相等。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s1.article, dealer, s1.price </span><br><span class="line"><span class="keyword">FROM</span> shop s1 </span><br><span class="line"><span class="keyword">JOIN</span> </span><br><span class="line">(</span><br><span class="line">   <span class="keyword">SELECT</span> article, <span class="keyword">MAX</span>(price) <span class="keyword">AS</span> price</span><br><span class="line">   <span class="keyword">FROM</span> shop</span><br><span class="line">   <span class="keyword">GROUP</span> <span class="keyword">BY</span> article</span><br><span class="line">) <span class="keyword">AS</span> s2</span><br><span class="line">   <span class="keyword">ON</span> s1.article = s2.article <span class="keyword">AND</span> s1.price = s2.price;</span><br></pre></td></tr></table></figure></p>
<p>或者：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> s1.article, s1.dealer, s1.price </span><br><span class="line"><span class="keyword">FROM</span> shop s1 </span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> shop s2 <span class="keyword">ON</span> s1.article = s2.article <span class="keyword">AND</span> s1.price &lt; s2.price </span><br><span class="line"><span class="keyword">WHERE</span> s2.article <span class="keyword">IS</span> <span class="literal">NULL</span>;</span><br></pre></td></tr></table></figure></p>
<h3 id="6-5-使用用户定义的变量"><a href="#6-5-使用用户定义的变量" class="headerlink" title="6.5 使用用户定义的变量"></a>6.5 使用用户定义的变量</h3><p>您可以使用MySQL用户变量记住结果，而不必将其存储在客户端中的临时变量中。<br>例如，要找到最高和最低价格的文章，您可以这样做：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT @min_price:=MIN(price),@max_price:=MAX(price) FROM shop; </span><br><span class="line">mysql&gt; SELECT * FROM shop WHERE price=@min_price OR price=@max_price; </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">| article | dealer | price | </span><br><span class="line">+<span class="comment">---------+--------+-------+ </span></span><br><span class="line">|    0003 | D      |  1.25 | </span><br><span class="line">|    0004 | D      | 19.95 | </span><br><span class="line">+<span class="comment">---------+--------+-------+</span></span><br></pre></td></tr></table></figure></p>
<h3 id="6-6-使用外键"><a href="#6-6-使用外键" class="headerlink" title="6.6 使用外键"></a>6.6 使用外键</h3><p>在MySQL中，InnoDB表支持检查外键约束。<br>外键约束涉及到两个表，但是，在定义时，对于除InnoDB之外的存储引擎而言，外键约束没有任何实际意义，仅仅作为备注或者注释。MySQL本身不会对外键进行任何检查，也不会进行任何操作，即：对于REFERENCES tbl_name(col_name)，即使你在定义时写了ON DELETE或者ON UPDATE，但是却不会有任何实际行为，即对外键无感知，因此，要使用外键功能还是要使用InnoDB。  </p>
<ul>
<li>MySQL不执行任何类型的CHECK，以确保col_name实际存在于tbl_name中（或者甚至tbl_name本身存在）。</li>
<li>MySQL也不会为了tbl_name执行任何额外的关联更新，这完全由存储引擎来完成。</li>
<li>该语法创建一个列;它不会创建任何类型的索引或键。<br>一个例子如下：<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> person (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">SMALLINT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="keyword">name</span> <span class="built_in">CHAR</span>(<span class="number">60</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> shirt (</span><br><span class="line">    <span class="keyword">id</span> <span class="built_in">SMALLINT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">    <span class="keyword">style</span> ENUM(<span class="string">'t-shirt'</span>, <span class="string">'polo'</span>, <span class="string">'dress'</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    color ENUM(<span class="string">'red'</span>, <span class="string">'blue'</span>, <span class="string">'orange'</span>, <span class="string">'white'</span>, <span class="string">'black'</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,</span><br><span class="line">    owner <span class="built_in">SMALLINT</span> <span class="keyword">UNSIGNED</span> <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">REFERENCES</span> person(<span class="keyword">id</span>),</span><br><span class="line">    PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> person <span class="keyword">VALUES</span> (<span class="literal">NULL</span>, <span class="string">'Antonio Paz'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="keyword">last</span> := <span class="keyword">LAST_INSERT_ID</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shirt <span class="keyword">VALUES</span></span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'polo'</span>, <span class="string">'blue'</span>, @<span class="keyword">last</span>),</span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'dress'</span>, <span class="string">'white'</span>, @<span class="keyword">last</span>),</span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'t-shirt'</span>, <span class="string">'blue'</span>, @<span class="keyword">last</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> person <span class="keyword">VALUES</span> (<span class="literal">NULL</span>, <span class="string">'Lilliana Angelovska'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> @<span class="keyword">last</span> := <span class="keyword">LAST_INSERT_ID</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> shirt <span class="keyword">VALUES</span></span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'dress'</span>, <span class="string">'orange'</span>, @<span class="keyword">last</span>),</span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'polo'</span>, <span class="string">'red'</span>, @<span class="keyword">last</span>),</span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'dress'</span>, <span class="string">'blue'</span>, @<span class="keyword">last</span>),</span><br><span class="line">(<span class="literal">NULL</span>, <span class="string">'t-shirt'</span>, <span class="string">'white'</span>, @<span class="keyword">last</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> person;</span><br><span class="line">+<span class="comment">----+---------------------+</span></span><br><span class="line">| id | name                |</span><br><span class="line">+<span class="comment">----+---------------------+</span></span><br><span class="line">|  1 | Antonio Paz         |</span><br><span class="line">|  2 | Lilliana Angelovska |</span><br><span class="line">+<span class="comment">----+---------------------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> shirt;</span><br><span class="line">+<span class="comment">----+---------+--------+-------+</span></span><br><span class="line">| id | style   | color  | owner |</span><br><span class="line">+<span class="comment">----+---------+--------+-------+</span></span><br><span class="line">|  1 | polo    | blue   |     1 |</span><br><span class="line">|  2 | dress   | white  |     1 |</span><br><span class="line">|  3 | t-shirt | blue   |     1 |</span><br><span class="line">|  4 | dress   | orange |     2 |</span><br><span class="line">|  5 | polo    | red    |     2 |</span><br><span class="line">|  6 | dress   | blue   |     2 |</span><br><span class="line">|  7 | t-shirt | white  |     2 |</span><br><span class="line">+<span class="comment">----+---------+--------+-------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">SELECT</span> s.* <span class="keyword">FROM</span> person p <span class="keyword">INNER</span> <span class="keyword">JOIN</span> shirt s</span><br><span class="line">   <span class="keyword">ON</span> s.owner = p.id</span><br><span class="line"> <span class="keyword">WHERE</span> p.name <span class="keyword">LIKE</span> <span class="string">'Lilliana%'</span></span><br><span class="line">   <span class="keyword">AND</span> s.color &lt;&gt; <span class="string">'white'</span>;</span><br><span class="line"></span><br><span class="line">+<span class="comment">----+-------+--------+-------+</span></span><br><span class="line">| id | style | color  | owner |</span><br><span class="line">+<span class="comment">----+-------+--------+-------+</span></span><br><span class="line">|  4 | dress | orange |     2 |</span><br><span class="line">|  5 | polo  | red    |     2 |</span><br><span class="line">|  6 | dress | blue   |     2 |</span><br><span class="line">+<span class="comment">----+-------+--------+-------+</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="6-7-在两个字段上进行搜索"><a href="#6-7-在两个字段上进行搜索" class="headerlink" title="6.7 在两个字段上进行搜索"></a>6.7 在两个字段上进行搜索</h3><p>使用单个字段的OR很容易优化，但是对于两个不同字段的OR就不好优化：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1_index, field2_index <span class="keyword">FROM</span> test_table </span><br><span class="line"><span class="keyword">WHERE</span> field1_index = <span class="string">'1'</span> <span class="keyword">OR</span>  field2_index = <span class="string">'1'</span></span><br></pre></td></tr></table></figure></p>
<p>这就不好优化，其实你可以这么做：每个SELECT搜索只有一个字段，可以优化查询：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> field1_index, field2_index</span><br><span class="line"><span class="keyword">FROM</span> test_table <span class="keyword">WHERE</span> field1_index = <span class="string">'1'</span> </span><br><span class="line"><span class="keyword">UNION</span> </span><br><span class="line"><span class="keyword">SELECT</span> field1_index, field2_index</span><br><span class="line"><span class="keyword">FROM</span> test_table <span class="keyword">WHERE</span> field2_index = <span class="string">'1'</span>;</span><br></pre></td></tr></table></figure></p>
<p>注意：UNION会去除结果集中重复的行，除非是有UNION ALL。  </p>
<h3 id="6-8-计算每天的访问量"><a href="#6-8-计算每天的访问量" class="headerlink" title="6.8 计算每天的访问量"></a>6.8 计算每天的访问量</h3><p>计算一个Web页面，在各个月之中有几天被访问到：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> t1 (<span class="keyword">year</span> <span class="keyword">YEAR</span>(<span class="number">4</span>), <span class="keyword">month</span> <span class="built_in">INT</span>(<span class="number">2</span>) <span class="keyword">UNSIGNED</span> ZEROFILL,</span><br><span class="line"><span class="keyword">day</span> <span class="built_in">INT</span>(<span class="number">2</span>) <span class="keyword">UNSIGNED</span> ZEROFILL); </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> t1 </span><br><span class="line"><span class="keyword">VALUES</span>(<span class="number">2000</span>,<span class="number">1</span>,<span class="number">1</span>),(<span class="number">2000</span>,<span class="number">1</span>,<span class="number">20</span>),(<span class="number">2000</span>,<span class="number">1</span>,<span class="number">30</span>),(<span class="number">2000</span>,<span class="number">2</span>,<span class="number">2</span>), (<span class="number">2000</span>,<span class="number">2</span>,<span class="number">23</span>),(<span class="number">2000</span>,<span class="number">2</span>,<span class="number">23</span>);</span><br></pre></td></tr></table></figure></p>
<p>示例表中包含用户访问页面的年、月、日。要确定每月有几天被访问到，请如下查询：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="keyword">year</span>,<span class="keyword">month</span>,<span class="keyword">BIT_COUNT</span>(<span class="keyword">BIT_OR</span>(<span class="number">1</span>&lt;&lt;<span class="keyword">day</span>)) <span class="keyword">AS</span> <span class="keyword">days</span> <span class="keyword">FROM</span> t1 <span class="keyword">GROUP</span> <span class="keyword">BY</span> <span class="keyword">year</span>,<span class="keyword">month</span>;</span><br><span class="line">+<span class="comment">------+-------+------+ </span></span><br><span class="line">| year | month | days | </span><br><span class="line">+<span class="comment">------+-------+------+ </span></span><br><span class="line">| 2000 |    01 |    3 | </span><br><span class="line">| 2000 |    02 |    2 | </span><br><span class="line">+<span class="comment">------+-------+------+</span></span><br></pre></td></tr></table></figure></p>
<p>该查询可以计算每年/月组合中表格中显示的不同天数，自动删除重复的条目。  </p>
<h3 id="6-9-使用AUTO-INCREMENT"><a href="#6-9-使用AUTO-INCREMENT" class="headerlink" title="6.9 使用AUTO_INCREMENT"></a>6.9 使用AUTO_INCREMENT</h3><p>AUTO_INCREMENT属性可用于为新行生成唯一标识：<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> animals (</span><br><span class="line"><span class="keyword">id</span> MEDIUMINT <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,      </span><br><span class="line"><span class="keyword">name</span> <span class="built_in">CHAR</span>(<span class="number">30</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span>,      </span><br><span class="line">PRIMARY <span class="keyword">KEY</span> (<span class="keyword">id</span>) </span><br><span class="line">);  </span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> animals (<span class="keyword">name</span>) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="string">'dog'</span>),(<span class="string">'cat'</span>),(<span class="string">'penguin'</span>),     </span><br><span class="line">(<span class="string">'lax'</span>),(<span class="string">'whale'</span>),(<span class="string">'ostrich'</span>);  </span><br><span class="line"><span class="keyword">SELECT</span> * <span class="keyword">FROM</span> animals;</span><br><span class="line">+<span class="comment">----+---------+ </span></span><br><span class="line">| id | name    | </span><br><span class="line">+<span class="comment">----+---------+ </span></span><br><span class="line">|  1 | dog     | </span><br><span class="line">|  2 | cat     | </span><br><span class="line">|  3 | penguin | </span><br><span class="line">|  4 | lax     | </span><br><span class="line">|  5 | whale   | </span><br><span class="line">|  6 | ostrich | </span><br><span class="line">+<span class="comment">----+---------+</span></span><br></pre></td></tr></table></figure></p>
<p>可以看到默认从1开始，如果没有启用SQL模式NO_AUTO_VALUE_ON_ZER，那么可以明确地将0分配给列以生成序列号。可以使用LAST_INSERT_ID（）SQL函数或mysql_insert_id（）C API函数检索最近自动生成的AUTO_INCREMENT值。这些功能是<strong><em>特定于连接</em></strong>的，所以它们的返回值不受另外一个也执行插入的连接的影响。<br>对于自增列，要合理的选用数据类型以保证可以容纳你的行。如果超过了范围，那么下一次自动生成序号时将失败。为了不让序号从1开始，你可以在CREATE TABLE或者ALTER TABLE中指定：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER TABLE tbl AUTO_INCREMENT = 100;</span><br></pre></td></tr></table></figure></p>
<p>关于AUTO_INCREMENT的更多信息和使用规则，见mysql手册。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          
            <a href="/tags/数据库/" rel="tag"># 数据库</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/23/database/mysql/mysql_manual/17-replication/1-configuring_replication/1_and_2-binary_log_file_pos_based_replication/" rel="next" title="基于二进制日志文件位置的复制配置">
                <i class="fa fa-chevron-left"></i> 基于二进制日志文件位置的复制配置
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/23/database/mysql/mysql_manual/8-optimization/1-optimization_overview/" rel="prev" title="优化概述">
                优化概述 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">xufubo</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">36</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">26</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Tutorial"><span class="nav-number">1.</span> <span class="nav-text">Tutorial</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1、连接和断开服务器"><span class="nav-number">1.1.</span> <span class="nav-text">1、连接和断开服务器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2、输入查询"><span class="nav-number">1.2.</span> <span class="nav-text">2、输入查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3、创建和使用数据库"><span class="nav-number">1.3.</span> <span class="nav-text">3、创建和使用数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-创建和选择数据库"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 创建和选择数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-创建表"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 创建表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-将数据装载到表中"><span class="nav-number">1.3.3.</span> <span class="nav-text">3.3 将数据装载到表中</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-从表中查询信息"><span class="nav-number">1.3.4.</span> <span class="nav-text">3.4 从表中查询信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-1-查询所有数据："><span class="nav-number">1.3.4.1.</span> <span class="nav-text">3.4.1 查询所有数据：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-2-选择特定的行"><span class="nav-number">1.3.4.2.</span> <span class="nav-text">3.4.2 选择特定的行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-3-选择特定的列"><span class="nav-number">1.3.4.3.</span> <span class="nav-text">3.4.3 选择特定的列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-4-排序行"><span class="nav-number">1.3.4.4.</span> <span class="nav-text">3.4.4 排序行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-5-日期计算"><span class="nav-number">1.3.4.5.</span> <span class="nav-text">3.4.5 日期计算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-6-使用NULL值"><span class="nav-number">1.3.4.6.</span> <span class="nav-text">3.4.6 使用NULL值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-7-模式匹配"><span class="nav-number">1.3.4.7.</span> <span class="nav-text">3.4.7 模式匹配</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-8-行计数"><span class="nav-number">1.3.4.8.</span> <span class="nav-text">3.4.8 行计数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-4-9-使用多个表"><span class="nav-number">1.3.4.9.</span> <span class="nav-text">3.4.9 使用多个表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4、获取数据库和表信息"><span class="nav-number">1.4.</span> <span class="nav-text">4、获取数据库和表信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5、在批处理模式下使用mysql"><span class="nav-number">1.5.</span> <span class="nav-text">5、在批处理模式下使用mysql</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6、常见的查询示例"><span class="nav-number">1.6.</span> <span class="nav-text">6、常见的查询示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-最大值"><span class="nav-number">1.6.0.1.</span> <span class="nav-text">6.1 最大值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-查询最大列的行"><span class="nav-number">1.6.1.</span> <span class="nav-text">6.2 查询最大列的行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-每个分组中的最大值"><span class="nav-number">1.6.2.</span> <span class="nav-text">6.3 每个分组中的最大值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-找出每组中包含特定列最大值的行"><span class="nav-number">1.6.3.</span> <span class="nav-text">6.4 找出每组中包含特定列最大值的行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-5-使用用户定义的变量"><span class="nav-number">1.6.4.</span> <span class="nav-text">6.5 使用用户定义的变量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-6-使用外键"><span class="nav-number">1.6.5.</span> <span class="nav-text">6.6 使用外键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-7-在两个字段上进行搜索"><span class="nav-number">1.6.6.</span> <span class="nav-text">6.7 在两个字段上进行搜索</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-8-计算每天的访问量"><span class="nav-number">1.6.7.</span> <span class="nav-text">6.8 计算每天的访问量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-9-使用AUTO-INCREMENT"><span class="nav-number">1.6.8.</span> <span class="nav-text">6.9 使用AUTO_INCREMENT</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xufubo</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
